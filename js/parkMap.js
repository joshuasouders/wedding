var map = L.map('parkMap').setView([39.297, -76.783829], 16);

L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
}).addTo(map);

var route = {
	"type": "FeatureCollection",
	"crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },                                                                            
	"features": [
		{ "type": "Feature", "properties": {}, "geometry": { "type": "LineString", "coordinates": [ [ -76.788447864207882, 39.295229727968348 ], [ -76.788328834856898, 39.295292893179457 ], [ -76.788226809698912, 39.295298156944483 ], [ -76.788155392088314, 39.295284997531191 ], [ -76.788039763575938, 39.295237623622853 ], [ -76.787910531709159, 39.295171826474764 ], [ -76.78761805958959, 39.294995489812969 ], [ -76.787277975729623, 39.29485073550493 ], [ -76.787053520382059, 39.294777042287699 ], [ -76.786795056648486, 39.294719140419751 ], [ -76.786608010525498, 39.294705980897625 ], [ -76.786475377820111, 39.294727036131839 ], [ -76.786335943437535, 39.294782306091506 ], [ -76.786244120795345, 39.294858631202182 ], [ -76.786145496475967, 39.294958643290222 ], [ -76.785965252030181, 39.294982330342791 ], [ -76.785853024356385, 39.295021808745901 ], [ -76.785689784103624, 39.295113924933297 ], [ -76.785509539657838, 39.295213936656658 ], [ -76.785257877601467, 39.29535342645331 ], [ -76.785128645734687, 39.295429750941381 ], [ -76.785026620576701, 39.295461333463841 ], [ -76.78489058703272, 39.295463965340069 ], [ -76.784747751811523, 39.295458701587513 ], [ -76.784540300656971, 39.295437646573326 ], [ -76.784445077176159, 39.295432382818795 ], [ -76.784326047825175, 39.295366585853742 ], [ -76.7841866134426, 39.295308684473333 ], [ -76.784077786607412, 39.29527446999878 ], [ -76.783934951386215, 39.295250783045049 ], [ -76.783832926228243, 39.295250783045049 ], [ -76.783727500231663, 39.295303420709104 ], [ -76.783632276750851, 39.295363953973855 ], [ -76.783547255785862, 39.295413959674818 ], [ -76.783407821403287, 39.295298156944483 ] ] } },
		{ "type": "Feature", "properties": {}, "geometry": { "type": "LineString", "coordinates": [ [ -76.78791733338636, 39.295737679927562 ], [ -76.788083974477743, 39.295669251381 ], [ -76.788182598797135, 39.295629773342959 ], [ -76.788308429825321, 39.295619245862376 ], [ -76.788420657499103, 39.295632405212849 ], [ -76.788502277625497, 39.295656092037461 ], [ -76.788614505299293, 39.295719256863919 ], [ -76.788706327941483, 39.295792949089424 ], [ -76.788777745552053, 39.295937701449418 ], [ -76.788784547229255, 39.296024552721754 ], [ -76.788784547229255, 39.296129826846823 ], [ -76.78876074135907, 39.29627194666454 ], [ -76.788689323748486, 39.296361429364737 ], [ -76.788556691043098, 39.296453543789589 ], [ -76.78845806672372, 39.296508812386314 ], [ -76.788271020600732, 39.296566712774194 ], [ -76.788121383702347, 39.296593031116501 ], [ -76.787954742610964, 39.296590399282707 ], [ -76.787879924161771, 39.296577240112299 ], [ -76.787784700680973, 39.29654039442201 ], [ -76.787631662944008, 39.296477230336379 ], [ -76.787492228561433, 39.296400906990222 ], [ -76.787407207596445, 39.296324583560853 ], [ -76.787288178245461, 39.296216677880814 ], [ -76.787016111157484, 39.295916646579286 ], [ -76.786876676774895, 39.29578242163339 ], [ -76.7867406432309, 39.295661355775181 ], [ -76.786594407171123, 39.295558712818369 ], [ -76.78644817111136, 39.295453437834546 ], [ -76.786325740921754, 39.295348162692427 ], [ -76.786179504861977, 39.29522183231294 ], [ -76.786131893121578, 39.295153403262205 ], [ -76.786097884735582, 39.295079710363545 ], [ -76.786111488089986, 39.295013913067052 ], [ -76.786148897314575, 39.294958643290215 ] ] } },
		{ "type": "Point", "properties" : {"popupHTML" : "<b>The Venue</b> - Shelter #300<br><img class=\"popupImage\" src=\"img/venue.jpg\">", "venue" : true}, "coordinates": [-76.783407821403287, 39.295298156944483]},
		{ "type": "Point", "properties" : {"popupHTML" : "<b>Restrooms</b>"}, "coordinates": [-76.78447,39.29521]},	
		{ "type": "Point", "properties" : {"popupHTML" : "<b>Park Gate</b> - Say you're here for the wedding in Shelter #300"}, "coordinates": [-76.78599,39.29505	]},
		{ "type": "Point", "properties" : {"popupHTML" : "<b>The Union Dam Trail</b> - A short but gorgeous trail that goes down to the water/railroad tracks and loops back around, stopping at the scenic overlook behind the park headquarters. Keep following the path and it'll put you back on the road near the park gate. Perfect for if you're looking for a short break from the festivities.<br><img class=\"popupImage\" src=\"img/uniondam.jpg\">"}, "coordinates": [-76.78279,39.29579	]},
		{ "type": "Point", "properties" : {"popupHTML" : "<b>Scenic overlook</b> of the railroad tracks, the water, and the Route 40 bridge.<br><img class=\"popupImage\" src=\"img/scenicoverlook.jpg\">"}, "coordinates": [-76.78516,39.29371 ]},
		{ "type": "Point", "properties" : {"popupHTML" : "<b>Route 40 Bridge</b><br><img class=\"popupImage\" src=\"img/route40.jpg\">"}, "coordinates": [-76.77856,39.29491]},	
	]
};

var venuePopup;

function onEachFeature(feature, layer) {
	var popup;
    // does this feature have a property named popupHTML?
    if (feature.properties && feature.properties.popupHTML) {
         popup = layer.bindPopup(feature.properties.popupHTML);
    }
    if(feature.properties.venue){
    	console.log("here");
    	venuePopup = popup;
    }
}


L.geoJson(route, {
    onEachFeature: onEachFeature
}).addTo(map);

venuePopup.openPopup();